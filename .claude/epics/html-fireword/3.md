---
name: Core Particle Engine Implementation
status: open
created: 2026-01-10T15:45:04Z
updated: 2026-01-10T15:48:33Z
github: https://github.com/TuanPhuong2020/html-fireword/issues/3
depends_on: [2]
parallel: false
conflicts_with: []
---

# Task: Core Particle Engine Implementation

## Description
Implement the core Firework class with particle system, physics simulation (gravity, velocity), requestAnimationFrame rendering loop, and Canvas 2D rendering. This is the foundational engine for all firework animations.

## Acceptance Criteria
- [ ] Firework class created with constructor accepting options (canvas element, default colors, particle config)
- [ ] `launch(x, y, overrides)` method triggers firework explosion at coordinates
- [ ] `stop()` method cleans up and removes canvas
- [ ] Internal `_createParticles(x, y)` generates particle array with random velocities
- [ ] Internal `_updateParticles()` applies physics (gravity, alpha decay) each frame
- [ ] Internal `_render()` draws particles to canvas using Canvas 2D API
- [ ] Internal `_animate()` implements requestAnimationFrame loop
- [ ] Particle data structure: `{ x, y, vx, vy, color, alpha, life }`
- [ ] Particles removed from array when alpha reaches 0
- [ ] Performance: Maintains 60fps with 100+ particles

## Technical Details
**Implementation Approach:**
- Firework class structure with constructor, launch, stop methods
- Particle generation with random velocities in circular pattern
- Physics: gravity constant ~0.1, linear alpha decay
- Canvas management: auto-create if not provided, overlay positioning
- requestAnimationFrame loop for 60fps rendering

**Key Considerations:**
- Use requestAnimationFrame for smooth 60fps
- Keep particle objects lightweight (plain objects, not classes)
- Default to 50 particles per firework
- Performance validation required

**Code Locations:**
- src/firework.js (main implementation)

## Dependencies
- [ ] Task 001 completed (build system must be ready to test)

## Effort Estimate
- Size: L
- Hours: 16-20 hours
- Parallel: false (requires project setup from Task 001)

## Definition of Done
- [ ] Firework class fully implemented
- [ ] Can launch firework with `new Firework().launch(400, 300)`
- [ ] Particles animate smoothly with gravity and fade
- [ ] Performance validated: 60fps with 100+ particles
- [ ] Code builds successfully with Rollup
- [ ] Manual testing in browser shows working fireworks
